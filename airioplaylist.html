<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ğŸµAirIo Music Highlight PlayerğŸµ</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 20px;
    }
    #player {
      margin-top: 20px;
    }
    .info {
      margin-top: 10px;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <h2>ğŸµAirIo Music Highlight PlayerğŸµ</h2>
  <div id="player"></div>
  <div class="info">
    <div><strong>Title:</strong> <span id="title">---</span></div>
    <div><strong>Artist:</strong> <span id="artist">---</span></div>
  </div>

  <script>
    // â˜…å‹•ç”»ãƒªã‚¹ãƒˆï¼ˆå‹•ç”»IDãƒ»é–‹å§‹ä½ç½®ãƒ»å†ç”Ÿæ™‚é–“ï¼ˆç§’ï¼‰ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚¢ãƒ¼ãƒã‚¹ãƒˆï¼‰
    const playSegments = [
      { videoId: "x0yocJ7M1A4", start: 46, duration: 120, title: "Deep Breath",                     artist: "ä¸€ä¹‹ç€¬ãƒ¦ãƒŠ" },
      { videoId: "qug0wZTMaWM", start: 43, duration: 120, title: "Innocent",                        artist: "ä¸€ä¹‹ç€¬ãƒ¦ãƒŠ" },
      { videoId: "8FK2DDy2hIw", start: 82, duration: 120, title: "Scarlet Loafers",                 artist: "Miho" },
      { videoId: "KLrBUfB7izw", start: 33, duration: 120, title: "ã¿ã‚“ãªãã®çµ±è¨ˆã€é–“é•ã£ã¦ã¾ã™ã‚ˆãƒ¼",        artist: "çµ±è¨ˆã‚·ã‚¹ã‚¿ãƒ¼ã‚º" },
      { videoId: "P4DLSdeyhjs", start: 40, duration: 120, title: "ã¡ã‚‡ã£ã¨å›ãã®æ¤œå®šã€ãŠã‹ã—ã„ã‚“ã˜ã‚ƒãªã€œã„ï¼Ÿ", artist: "çµ±è¨ˆã‚·ã‚¹ã‚¿ãƒ¼ã‚º" },
      { videoId: "cwNJ50lPBaY", start: 20, duration: 120, title: "ãƒ¬ã‚¸ã®æ¨ªã§å¾…ã£ã¦ã‚‹ã‚ˆ",                 artist: "ã¨ã‚Šã¾ã‚‹" },
      { videoId: "OYuf9rKviAU", start: 34, duration: 120, title: "ã¤ãªãŒã‚Šã®å¥‡è·¡",                      artist: "ä¸€ä¹‹ç€¬ãƒ¦ãƒŠ" },
      { videoId: "BRCa_s0m38w", start: 37, duration: 120, title: "ä¸‰è§’ãƒ•ãƒ©ã‚¹ã‚³ã®ãƒ¯ãƒ«ãƒ„",                 artist: "ã‚¨ã‚¢ãƒªã‚ªæ­ŒåŠ‡å›£" }
    ];

    let player;
    let segmentTimer = null;
    let isSegmentPlaying = false;
    let lastIndex = -1; // å‰å›ã®å‹•ç”»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

    // YouTube API èª­ã¿è¾¼ã¿
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '390',
        width: '640',
        playerVars: {
          autoplay: 1,
          mute: 1
        },
        events: {
          onReady: () => {
            player.mute(); // è‡ªå‹•å†ç”Ÿè¨±å¯ã®ãŸã‚ãƒŸãƒ¥ãƒ¼ãƒˆ
            playRandomSegment();
          },
          onStateChange: onPlayerStateChange
        }
      });
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.PLAYING && !isSegmentPlaying) {
        isSegmentPlaying = true;
        const currentSegment = player.getVideoData();
        const currentIndex = playSegments.findIndex(seg => seg.videoId === currentSegment.video_id);
        if (currentIndex !== -1) {
          const duration = playSegments[currentIndex].duration;
          segmentTimer = setTimeout(() => {
            playRandomSegment();
          }, duration * 1000);
        } else {
          playRandomSegment();
        }
      }
    }

    function playRandomSegment() {
      clearTimeout(segmentTimer);
      isSegmentPlaying = false;

      let index;
      do {
        index = Math.floor(Math.random() * playSegments.length);
      } while (index === lastIndex && playSegments.length > 1);

      lastIndex = index;

      const segment = playSegments[index];

      // å‹•ç”»ã®ãƒ­ãƒ¼ãƒ‰
      player.loadVideoById({
        videoId: segment.videoId,
        startSeconds: segment.start
      });

      // ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåã®è¡¨ç¤º
      document.getElementById("title").textContent = segment.title;
      document.getElementById("artist").textContent = segment.artist;
    }
  </script>
</body>
</html>
