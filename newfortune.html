<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <!-- モバイル表示に最適化 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>骨筋肉占い - キラリ☆今日の運勢</title>
  <style>
    /* 全体：メイリオ・Meiryo を使用 */
    body {
      margin: 0;
      padding: 0;
      font-family: "メイリオ", Meiryo, sans-serif;
      background: linear-gradient(135deg, #fdeff9, #c1e3f8);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #333;
    }
    /* コンテナ：画面幅いっぱいに表示 */
    .container {
      background: #fff;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      padding: 30px 25px;
      width: 95%;
      max-width: 600px;
      margin: 10px;
      text-align: center;
    }
    /* 各ステップは初期は非表示 */
    .step { display: none; }
    /* タイトル */
    h1 { margin-bottom: 15px; color: #d81b60; }
    h2 { margin-bottom: 15px; color: #d81b60; }
    /* オプション選択（イラスト） */
    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      margin-bottom: 20px;
    }
    .option {
      width: 30%;
      margin: 10px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .option:hover {
      transform: scale(1.05);
    }
    .option img {
      width: 100%;
      max-width: 100px;
      height: auto;
      border-radius: 50%;
      border: 2px solid #d81b60;
      margin-bottom: 5px;
    }
    .option span {
      display: block;
      font-size: 1.1em;
      color: #333;
    }
    /* 戻る・その他のボタン */
    button {
      background: #d81b60;
      color: #fff;
      border: none;
      padding: 10px 15px;
      font-size: 1em;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }
    button:hover { background: #ad113e; }
    hr {
      border: none;
      border-top: 1px dashed #d81b60;
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ステップ1：自分の性別を選択 -->
    <div id="step1" class="step">
      <!-- ここでタイトル表示 -->
      <h1>骨筋肉占い</h1>
      <h2>自分の性別を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectGender('female')">
          <img src="img/female.png" alt="女">
          <span>女</span>
        </div>
        <div class="option" onclick="selectGender('male')">
          <img src="img/male.png" alt="男">
          <span>男</span>
        </div>
        <div class="option" onclick="selectGender('unknown')">
          <img src="img/unknown.png" alt="LGBTQ">
          <span>LGBTQ</span>
        </div>
      </div>
    </div>

    <!-- ステップ2：自分の干支を選択 -->
    <div id="step2" class="step">
      <h2>自分の干支を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectUserEto('rat')">
          <img src="img/rat.png" alt="子（ねずみ）">
          <span>子</span>
        </div>
        <div class="option" onclick="selectUserEto('ox')">
          <img src="img/ox.png" alt="丑（うし）">
          <span>丑</span>
        </div>
        <div class="option" onclick="selectUserEto('tiger')">
          <img src="img/tiger.png" alt="寅（とら）">
          <span>寅</span>
        </div>
        <div class="option" onclick="selectUserEto('rabbit')">
          <img src="img/rabbit.png" alt="卯（うさぎ）">
          <span>卯</span>
        </div>
        <div class="option" onclick="selectUserEto('dragon')">
          <img src="img/dragon.png" alt="辰（たつ）">
          <span>辰</span>
        </div>
        <div class="option" onclick="selectUserEto('snake')">
          <img src="img/snake.png" alt="巳（へび）">
          <span>巳</span>
        </div>
        <div class="option" onclick="selectUserEto('horse')">
          <img src="img/horse.png" alt="午（うま）">
          <span>午</span>
        </div>
        <div class="option" onclick="selectUserEto('goat')">
          <img src="img/goat.png" alt="未（ひつじ）">
          <span>未</span>
        </div>
        <div class="option" onclick="selectUserEto('monkey')">
          <img src="img/monkey.png" alt="申（さる）">
          <span>申</span>
        </div>
        <div class="option" onclick="selectUserEto('rooster')">
          <img src="img/rooster.png" alt="酉（とり）">
          <span>酉</span>
        </div>
        <div class="option" onclick="selectUserEto('dog')">
          <img src="img/dog.png" alt="戌（いぬ）">
          <span>戌</span>
        </div>
        <div class="option" onclick="selectUserEto('boar')">
          <img src="img/boar.png" alt="亥（いのしし）">
          <span>亥</span>
        </div>
      </div>
      <button onclick="backStep('step1')">戻る</button>
    </div>

    <!-- ステップ3：自分の星座を選択 -->
    <div id="step3" class="step">
      <h2>自分の星座を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectUserZodiac('aries')">
          <img src="img/aries.png" alt="牡羊座">
          <span>牡羊</span>
        </div>
        <div class="option" onclick="selectUserZodiac('taurus')">
          <img src="img/taurus.png" alt="牡牛座">
          <span>牡牛</span>
        </div>
        <div class="option" onclick="selectUserZodiac('gemini')">
          <img src="img/gemini.png" alt="双子座">
          <span>双子</span>
        </div>
        <div class="option" onclick="selectUserZodiac('cancer')">
          <img src="img/cancer.png" alt="蟹座">
          <span>蟹</span>
        </div>
        <div class="option" onclick="selectUserZodiac('leo')">
          <img src="img/leo.png" alt="獅子座">
          <span>獅子</span>
        </div>
        <div class="option" onclick="selectUserZodiac('virgo')">
          <img src="img/virgo.png" alt="乙女座">
          <span>乙女</span>
        </div>
        <div class="option" onclick="selectUserZodiac('libra')">
          <img src="img/libra.png" alt="天秤座">
          <span>天秤</span>
        </div>
        <div class="option" onclick="selectUserZodiac('scorpio')">
          <img src="img/scorpio.png" alt="蠍座">
          <span>蠍</span>
        </div>
        <div class="option" onclick="selectUserZodiac('sagittarius')">
          <img src="img/sagittarius.png" alt="射手座">
          <span>射手</span>
        </div>
        <div class="option" onclick="selectUserZodiac('capricorn')">
          <img src="img/capricorn.png" alt="山羊座">
          <span>山羊</span>
        </div>
        <div class="option" onclick="selectUserZodiac('aquarius')">
          <img src="img/aquarius.png" alt="水瓶座">
          <span>水瓶</span>
        </div>
        <div class="option" onclick="selectUserZodiac('pisces')">
          <img src="img/pisces.png" alt="魚座">
          <span>魚</span>
        </div>
      </div>
      <button onclick="backStep('step2')">戻る</button>
    </div>

    <!-- ステップ4：相性占いの場合、相手の性別を選択 -->
    <div id="step4" class="step">
      <h2>相性を占う場合は<br>相手の性別を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectPartnerGender('female')">
          <img src="img/female.png" alt="女">
          <span>女</span>
        </div>
        <div class="option" onclick="selectPartnerGender('male')">
          <img src="img/male.png" alt="男">
          <span>男</span>
        </div>
        <div class="option" onclick="selectPartnerGender('unknown')">
          <img src="img/unknown.png" alt="LGBTQ">
          <span>LGBTQ</span>
        </div>
        <div class="option" onclick="selectPartnerGender('unnecessary')">
          <img src="img/unnecessary.png" alt="スキップ">
          <span>Skip</span>
        </div>
      </div>
      <button onclick="backStep('step3')">戻る</button>
    </div>

    <!-- ステップ5：相手の干支選択 -->
    <div id="step5" class="step">
      <h2>相手の干支を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectPartnerEto('rat')">
          <img src="img/rat.png" alt="子">
          <span>子</span>
        </div>
        <div class="option" onclick="selectPartnerEto('ox')">
          <img src="img/ox.png" alt="丑">
          <span>丑</span>
        </div>
        <div class="option" onclick="selectPartnerEto('tiger')">
          <img src="img/tiger.png" alt="寅">
          <span>寅</span>
        </div>
        <div class="option" onclick="selectPartnerEto('rabbit')">
          <img src="img/rabbit.png" alt="卯">
          <span>卯</span>
        </div>
        <div class="option" onclick="selectPartnerEto('dragon')">
          <img src="img/dragon.png" alt="辰">
          <span>辰</span>
        </div>
        <div class="option" onclick="selectPartnerEto('snake')">
          <img src="img/snake.png" alt="巳">
          <span>巳</span>
        </div>
        <div class="option" onclick="selectPartnerEto('horse')">
          <img src="img/horse.png" alt="午">
          <span>午</span>
        </div>
        <div class="option" onclick="selectPartnerEto('goat')">
          <img src="img/goat.png" alt="未">
          <span>未</span>
        </div>
        <div class="option" onclick="selectPartnerEto('monkey')">
          <img src="img/monkey.png" alt="申">
          <span>申</span>
        </div>
        <div class="option" onclick="selectPartnerEto('rooster')">
          <img src="img/rooster.png" alt="酉">
          <span>酉</span>
        </div>
        <div class="option" onclick="selectPartnerEto('dog')">
          <img src="img/dog.png" alt="戌">
          <span>戌</span>
        </div>
        <div class="option" onclick="selectPartnerEto('boar')">
          <img src="img/boar.png" alt="亥">
          <span>亥</span>
        </div>
      </div>
      <button onclick="backStep('step4')">戻る</button>
    </div>

    <!-- ステップ6：相手の星座選択 -->
    <div id="step6" class="step">
      <h2>相手の星座を選んでください</h2>
      <div class="options">
        <div class="option" onclick="selectPartnerZodiac('aries')">
          <img src="img/aries.png" alt="牡羊座">
          <span>牡羊</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('taurus')">
          <img src="img/taurus.png" alt="牡牛座">
          <span>牡牛</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('gemini')">
          <img src="img/gemini.png" alt="双子座">
          <span>双子</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('cancer')">
          <img src="img/cancer.png" alt="蟹座">
          <span>蟹</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('leo')">
          <img src="img/leo.png" alt="獅子座">
          <span>獅子</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('virgo')">
          <img src="img/virgo.png" alt="乙女座">
          <span>乙女</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('libra')">
          <img src="img/libra.png" alt="天秤座">
          <span>天秤</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('scorpio')">
          <img src="img/scorpio.png" alt="蠍座">
          <span>蠍</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('sagittarius')">
          <img src="img/sagittarius.png" alt="射手座">
          <span>射手</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('capricorn')">
          <img src="img/capricorn.png" alt="山羊座">
          <span>山羊</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('aquarius')">
          <img src="img/aquarius.png" alt="水瓶座">
          <span>水瓶</span>
        </div>
        <div class="option" onclick="selectPartnerZodiac('pisces')">
          <img src="img/pisces.png" alt="魚座">
          <span>魚</span>
        </div>
      </div>
      <button onclick="backStep('step5')">戻る</button>
    </div>

    <!-- ステップ7：占い結果表示 -->
    <div id="step7" class="step">
      <h2>占い結果</h2>
      <div id="resultContent"></div>
      <div id="resultButtons"></div>
    </div>

    <!-- ステップ8：相性診断結果 -->
    <div id="step8" class="step">
      <h2>相性診断結果</h2>
      <div id="compatibilityResult"></div>
      <button onclick="finish()">終了</button>
    </div>
  </div>

  <script>
    // グローバル変数：入力内容と占い結果を保存
    var userData = {
      gender: null,
      eto: null,
      zodiac: null,
      partnerGender: null,
      partnerEto: null,
      partnerZodiac: null,
      userFortune: null,
      partnerFortune: null
    };

    // 指定のステップのみ表示する
    function showStep(stepId) {
      var steps = document.getElementsByClassName('step');
      for (var i = 0; i < steps.length; i++) {
        steps[i].style.display = 'none';
      }
      document.getElementById(stepId).style.display = 'block';
    }
    // 戻るボタン用
    function backStep(stepId) {
      showStep(stepId);
    }

    // ステップ1：自分の性別選択
    function selectGender(gender) {
      userData.gender = gender;
      showStep('step2');
    }

    // ステップ2：自分の干支選択
    function selectUserEto(eto) {
      userData.eto = eto;
      showStep('step3');
    }

    // ステップ3：自分の星座選択
    function selectUserZodiac(zodiac) {
      userData.zodiac = zodiac;
      showStep('step4');
    }

    // ステップ4：相手の性別選択
    function selectPartnerGender(gender) {
      userData.partnerGender = gender;
      if (gender === 'unnecessary') {
        // 相手占い不要の場合は結果表示へ
        showResults();
      } else {
        showStep('step5');
      }
    }

    // ステップ5：相手の干支選択
    function selectPartnerEto(eto) {
      userData.partnerEto = eto;
      showStep('step6');
    }

    // ステップ6：相手の星座選択
    function selectPartnerZodiac(zodiac) {
      userData.partnerZodiac = zodiac;
      showResults();
    }

    // 占い結果の計算（共通関数）
    function computeFortune(gender, zodiac, eto, now) {
      var year  = now.getFullYear();
      var month = now.getMonth() + 1;
      var day   = now.getDate();
      var hour  = now.getHours();
      
      // 数値変換：※性別は "male"→1, "female"→2, それ以外→3
      var genderValue = (gender === 'male') ? 1 : (gender === 'female') ? 2 : 3;
      var zodiacValue;
      switch(zodiac) {
        case 'aries': zodiacValue = 1; break;
        case 'taurus': zodiacValue = 2; break;
        case 'gemini': zodiacValue = 3; break;
        case 'cancer': zodiacValue = 4; break;
        case 'leo': zodiacValue = 5; break;
        case 'virgo': zodiacValue = 6; break;
        case 'libra': zodiacValue = 7; break;
        case 'scorpio': zodiacValue = 8; break;
        case 'sagittarius': zodiacValue = 9; break;
        case 'capricorn': zodiacValue = 10; break;
        case 'aquarius': zodiacValue = 11; break;
        case 'pisces': zodiacValue = 12; break;
        default: zodiacValue = 0;
      }
      var etoValue;
      switch(eto) {
        case 'rat': etoValue = 1; break;
        case 'ox': etoValue = 2; break;
        case 'tiger': etoValue = 3; break;
        case 'rabbit': etoValue = 4; break;
        case 'dragon': etoValue = 5; break;
        case 'snake': etoValue = 6; break;
        case 'horse': etoValue = 7; break;
        case 'goat': etoValue = 8; break;
        case 'monkey': etoValue = 9; break;
        case 'rooster': etoValue = 10; break;
        case 'dog': etoValue = 11; break;
        case 'boar': etoValue = 12; break;
        default: etoValue = 0;
      }
      var seed = year + month + day + hour + genderValue + zodiacValue + etoValue;
      
      var bones = [
        "頑丈な大腿骨", "しなやかな脊椎", "強固な鎖骨", "神秘的な肋骨",
        "しっかりした上腕骨", "華麗な橈骨", "優美な尺骨", "美しい手根骨",
        "雄大な脛骨", "優雅な腓骨", "神聖な指骨", "古代の寛骨",
        "輝く頭蓋骨", "柔軟な胸骨", "勇敢な膝蓋骨", "堅牢な下顎骨",
        "光輝く肩甲骨", "静謐な尾骨", "風格ある頬骨", "洗練されたあぶみ骨",
        "大地を感じる踵骨", "神々しい鼻骨", "奇跡の距骨", "未来を拓く舌骨"
      ];
      var muscles = [
        "逞しい大胸筋", "引き締まった腹直筋", "力強い大腿四頭筋", "しなやかな上腕二頭筋",
        "驚異の三角筋", "雄々しい広背筋", "躍動する前鋸筋", "柔軟な大内転筋",
        "発達した僧帽筋", "鋭敏な腸腰筋", "躍動感あふれる大臀筋", "力強い下腿三頭筋",
        "繊細な小円筋", "洗練された側頭筋", "勇猛な腕橈骨筋", "静寂な脊柱起立筋",
        "堅実な上腕三頭筋", "雄大な大腿二頭筋", "飛翔する外腹斜筋", "調和の内腹斜筋",
        "神秘の前脛骨筋", "芸術的な胸鎖乳突筋", "未来を創る菱形筋", "古典的な肩甲下筋"
      ];
      var boneIndex = seed % bones.length;
      var muscleIndex = (seed * 7) % muscles.length;
      var boneResult = bones[boneIndex];
      var muscleResult = muscles[muscleIndex];
      
      // キーワードで関連チェック
      var keywords = ["大腿", "上腕", "橈骨", "脛骨", "肩甲", "頭蓋", "胸", "下腿"];
      var related = false;
      for (var i = 0; i < keywords.length; i++) {
        if (boneResult.indexOf(keywords[i]) !== -1 &&
            muscleResult.indexOf(keywords[i]) !== -1) {
          related = true;
          break;
        }
      }
      return { bone: boneResult, muscle: muscleResult, related: related, seed: seed };
    }

    // ステップ7：結果表示画面
    function showResults() {
      var now = new Date();
      // 自分の占い結果を計算
      userData.userFortune = computeFortune(userData.gender, userData.zodiac, userData.eto, now);
      var html = "<h3>あなたの結果</h3>";
      html += "<p>骨: <strong>" + userData.userFortune.bone + "</strong></p>";
      html += "<p>筋肉: <strong>" + userData.userFortune.muscle + "</strong></p>";
      if (userData.userFortune.related) {
        html += "<p style='color:#d81b60; font-weight:bold;'>おめでとうございます！</p>";
      }
      
      // パートナー入力があれば結果も表示
      if (userData.partnerGender !== "unnecessary" && userData.partnerGender !== null) {
        userData.partnerFortune = computeFortune(userData.partnerGender, userData.partnerZodiac, userData.partnerEto, now);
        html += "<hr><h3>相手の結果</h3>";
        html += "<p>骨: <strong>" + userData.partnerFortune.bone + "</strong></p>";
        html += "<p>筋肉: <strong>" + userData.partnerFortune.muscle + "</strong></p>";
        if (userData.partnerFortune.related) {
          html += "<p style='color:#d81b60; font-weight:bold;'>おめでとうございます！</p>";
        }
      }
      
      document.getElementById('resultContent').innerHTML = html;
      
      // ボタン設定：パートナーありなら相性診断ボタンを表示
      var btnHTML = "";
      if (userData.partnerGender !== "unnecessary" && userData.partnerGender !== null) {
        btnHTML += "<button onclick='showCompatibility()'>相性診断</button> ";
      }
      btnHTML += "<button onclick='finish()'>終了</button>";
      document.getElementById('resultButtons').innerHTML = btnHTML;
      
      showStep('step7');
    }

    // ステップ8：相性診断結果表示
    function showCompatibility() {
      var compScore = (userData.userFortune.seed + userData.partnerFortune.seed) % 101;
      var html = "<p>あなたたちの相性は <strong>" + compScore + "%</strong> です！</p>";
      if (compScore >= 80) {
        html += "<p style='color:#d81b60; font-weight:bold;'>おめでとうございます！</p>";
      }
      document.getElementById('compatibilityResult').innerHTML = html;
      showStep('step8');
    }

    // 終了：全体リセットして最初の画面へ
    function finish() {
      userData = {
        gender: null,
        eto: null,
        zodiac: null,
        partnerGender: null,
        partnerEto: null,
        partnerZodiac: null,
        userFortune: null,
        partnerFortune: null
      };
      showStep('step1');
    }

    // 初回はステップ1を表示
    window.onload = function() {
      showStep('step1');
    };
  </script>
</body>
</html>
